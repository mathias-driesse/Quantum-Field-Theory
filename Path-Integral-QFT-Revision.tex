%!TEX program = lualatex
\documentclass{article}
\usepackage{physics, amsmath, amsfonts, empheq, mathtools, booktabs, hyperref, simpler-wick, tikz-feynman, slashed}
\usepackage[style=nature, autocite = inline]{biblatex}
\usepackage[margin=1in]{geometry}

\setlength{\parindent}{0pt}
\numberwithin{equation}{section}

\newcommand*\widefbox[1]{\fbox{\hspace{2em}#1\hspace{2em}}}
\newcommand{\normord}[1]{:\mathrel{#1}:}

\title{Path Integral Quantum Field Theory}
\author{Mathias Driesse}

\begin{document}

\maketitle

\section{Gaussian Integrals}

The general Gaussian integral, for a complex, symmetric $n\times n$ matrix $A$ such that $\Re A \geq 0$ and the eigenvalues $a_i$ of $A$ are nonzero, is given by 

\begin{empheq}[box=\widefbox]{align}
    Z_A(b) = \int d^nx \exp\left(-\frac{1}{2} \sum_{i,j = 1}^n x_i A_{ij}x_j + \sum_{i=1}^n b_i x_i\right) = (2\pi)^{n/2} (\det A)^{-1/2} \exp\left(\frac{1}{2}\sum_{i,j = 1}^n b_i A_{ij}^{-1}b_j \right).
\end{empheq}

Let $\mu$ be a measure in $\mathbb{R}^n$; we define the expectation value

\begin{equation}
\begin{aligned}
    \ev{F}_\mu &= \int d\mu(x)F(x) \\
    &= \int d^nx\, \Omega(x)F(x).
\end{aligned}
\end{equation}

The measure is normalized so that 
\begin{equation}
    \int d\mu(x) = 1.
\end{equation}

We define the generating function 
\begin{equation}
    Z_\mu(b) = \ev{e^{(b,x)}}_\mu = \int d\mu(x) \exp\left(\sum_{i=1}^n b_i x_i\right),
\end{equation}

which is a function of the $n$-dimensional vector $b$ and the measure $\mu$. The integrand can be expanded
\begin{equation}
    \exp\left(\sum_{i=1}^n b_i x_i\right) = \sum_{\ell=0}^\infty \frac{1}{\ell!} \sum_{i_1 \cdots i_\ell = 1}^n b_{i_1} \cdots b_{i_\ell} x_{i_1} \cdots x_{i_\ell}.
\end{equation}
Therefore, substituting the definition of the correlator
\begin{equation}
    \ev{x_{i_1} \cdots x_{i_\ell}}_\mu = \int d\mu(x) x_{i_1} \cdots x_{i_\ell}
\end{equation}
we obtain 
\begin{equation}
    Z_\mu(b) = \sum_{\ell=0}^\infty \frac{1}{\ell!} \sum_{i_1 \cdots i_\ell = 1}^n b_{i_1} \cdots b_{i_\ell} \ev{x_{i_1} \cdots x_{i_\ell}}_\mu.
\end{equation}
Furthermore, it is useful to notice that
\begin{equation}
    \pdv{b_k} Z_\mu(b) = \int d\mu(x)x_k \exp\left(\sum_{i=1}^n b_i x_i\right),
\end{equation}
which allows the correlaters to be written as
\begin{equation}
    \ev{x_{i_1} \cdots x_{i_\ell}}_\mu = \pdv{b_{i_1}} \cdots \pdv{b_{i_\ell}} Z_\mu(b) \eval_{b=0}.
\end{equation}

Let us consder the Gaussian measure
\begin{equation} \label{eq:gaussian_measure}
    d\mu_0(x) = d^nx\, \Omega_0(x) = d^nx \, \mathcal{N}_0 \exp\left(-\frac{1}{2}\sum_{i,j=0}^n x_i A_{ij}x_j\right),
\end{equation}
where the normalization $\mathcal{N}_0$ is fixed by the normalization of the measure:
\begin{equation}
    \mathcal{N}_0 = (2\pi)^{-n/2} (\det A)^{1/2}.
\end{equation}
The generating function in this case can be readily computed using the boxed equation above:
\begin{equation}
    Z(b) = \frac{Z_A(b)}{Z_A(0)} = \exp\left(\frac{1}{2}\sum_{i,j = 1}^n b_i A_{ij}^{-1} b_j\right).
\end{equation}
In the future, we will drop any subscript $A$ when referring to a Gaussian measure for simplicity. And therefore, defining $\Delta_{ij} = A_{ij}^{-1}$, 
\begin{empheq}[box=\widefbox]{align} \label{eq:correlator}
    \ev{x_{i_1}\cdots x_{i_\ell} }_0 = \pdv{b_{i_1}} \cdots \pdv{b_{i_\ell}} \eval{\exp\left(\frac{1}{2}\sum_{i,j=1}^n b_i \Delta_{ij} b_j\right)}_{b=0}.
\end{empheq}

\subsection{Wick's Theorem}

Let us start with a couple explicit examples, which we will compute in full detail in order to get familiar with the algebraic manipulations.

\textbf{One-point function}: Let $k$ be an integer between 1 and $n$, we have 
\begin{equation}
\begin{aligned}
    \ev{x_k}_0 &= \pdv{b_k} \eval{\exp\left(\frac{1}{2}\sum_{i,j = 1}^n b_i \Delta_{ij} b_j \right)}_{b=0} \\
    &= \left(\frac{1}{2}\sum_{j=1}^n \Delta_{kj}b_j + \frac{1}{2}\sum_{i=1}^n b_i \Delta_{ik} \right)\eval{\exp\left(\frac{1}{2}\sum_{i,j = 1}^n b_i \Delta_{ij} b_j \right)}_{b=0} \\
    &= \left(\sum_{j=1}^n \Delta_{kj}b_j\right)\eval{\exp\left(\frac{1}{2}\sum_{i,j = 1}^n b_i \Delta_{ij} b_j \right)}_{b=0} \\
    &= 0,
\end{aligned}
\end{equation}
where the last equality comes from the fact that the expression is linear in $b$, and we need to set $b=0$.

\textbf{Two-point function}: We now consider a pair of indices $k$, $l$, and compute
\begin{equation}
\begin{aligned}
    \ev{x_k x_l}_0 &= \pdv{b_l} \pdv{b_k} \eval{\exp\left(\frac{1}{2}\sum_{i,j = 1}^n b_i \Delta_{ij} b_j \right)}_{b=0} \\
    &= \left[\Delta_{kl} + \left(\sum_{j=1}^n \Delta_{kj} b_j \right) \left(\sum_{m=1}^n \Delta_{lm} b_m \right)\right] \eval{\exp\left(\frac{1}{2}\sum_{i,j = 1}^n b_i \Delta_{ij} b_j \right)}_{b=0} \\
    &= \Delta_{kl}
\end{aligned}
\end{equation}

Thus, the generating function $Z(b)$ provides a systematic way to compute all correlators for a multi-dimensional Gaussian distribution. Having understood the general rule for such a process, we can generate a recipe to compute $\ev{x_{i_1} \cdots x_{i_\ell}}_0$, known as \textit{Wick's Theorem}:
\begin{itemize}
    \item Write down each $x_{i_1} \cdots x_{i_\ell}$ and organize them pairwise $(i_p, i_q)$. Note that if $\ell$ must be even for the correlator to be non-zero.
    \item There are $(\ell - 1)\times(\ell-3) \times \cdots \times 3 \times 1$ ways of doing this. Sum over all of these possible pairings.
    \item To each pair $(i_p, i_q)$ associate a factor $\Delta_{i_p i_q}$.
\end{itemize}

Let us revisit our result for the \textbf{two-point function}: for $\ev{x_{i_1} x_{i_2}}_0$, there is only one possible pairing $(i_1, i_2)$. Therefore
\begin{equation}
    \ev{x_{i_1} x_{i_2}}_0 = \Delta_{i_1 i_2}.
\end{equation}

\textbf{Four-point function}: For $\ev{x_{i_1} x_{i_2} x_{i_3} x_{i_4}}_0$, there are three different pairings
\begin{equation}
    P=\left\{\left\{\left(i_1, i_2\right),\left(i_3, i_4\right)\right\},\left\{\left(i_1, i_3\right),\left(i_2, i_4\right)\right\},\left\{\left(i_1, i_4\right),\left(i_2, i_3\right)\right\}\right\}
\end{equation}

Wick's theorem then yields 
\begin{equation}
    \ev{x_{i_1} x_{i_2} x_{i_3} x_{i_4}}_0=\Delta_{i_1 i_2} \Delta_{i_3 i_4}+\Delta_{i_1 i_3} \Delta_{i_2 i_4}+\Delta_{i_1 i_4} \Delta_{i_2 i_3}.
\end{equation}

We can also represent these pairings, \textit{Wick contractions}, as should be familiar from canonical quantum field theory:
\begin{equation}
    \ev{x_i x_j}_0 = \Delta_{ij} = \wick{\c x_i \c x_j}
\end{equation}

\subsection{Perturbed Gaussian Measure}

Let us now consider a more complicated measure,
\begin{equation}
    \Omega(x) = \frac{1}{Z(\lambda)}e^{-S(x, \lambda)},
\end{equation}
where the normalization is given as usual by 
\begin{equation}
    Z(\lambda) = \int d^nx e^{-S(x,\lambda)}
\end{equation}
and
\begin{equation}
\begin{aligned}
    S(x, \lambda) &= \frac{1}{2} \sum_{i, j = 1}^n x_i A_{ij}x_j + \lambda V(x) \\
    &= S_0(x) + \lambda V(x).
\end{aligned}
\end{equation}
We call $V(\lambda)$ the potential term, foreshadowing the physics we will be doing using the perturbed Gaussian measure. Furthermore
\begin{equation}
\begin{aligned}
    Z(\lambda) &= \sum_{k=0}^\infty \frac{(-\lambda)^k}{k!} \int d^nx \, V^k(x) \exp\left(-\frac{1}{2} \sum_{i,j=1}^n x_i A_{ij} x_j\right) \\
    &= Z(0) \sum_{k=0}^\infty \frac{(-\lambda)^k}{k!} \ev{V^k(x)}_0,
\end{aligned}
\end{equation}
where in the first line we have expanded the exponential term containing $e^V(x)$ and in the second line used
\begin{equation}
    \ev{F(x)}_0 = \frac{1}{Z(0)} \int d^nx \exp\left(-\frac{1}{2} \sum_{i,j=1}^n x_i A_{ij} x_j\right) F(x),
\end{equation}
and $1/Z(0)$ referring to the normalization constant $\mathcal{N}_0$ from Eq. \ref{eq:gaussian_measure}. Recalling Eq. \ref{eq:correlator}, given that $F(x)$ admits a Taylor expansion
\begin{equation}
\begin{aligned}
    F(x) &= \sum_{\ell = 0}^\infty \sum_{i_1 \cdots i_\ell = 1}^n F_{i_1 \cdots i_\ell} x_{i_1} \cdots x_{i_\ell} \\
    &= F_0 + F_1 x_1 + \cdots + F_n x_n\\
    &\quad + F_{11} x_1^2 + F_{12} x_1 x_2 + \cdots + F_{nn} x_n^2 \\
    &\quad + \cdots
\end{aligned}
\end{equation}
where $F_{i_1 \cdots i_\ell}$ refer to the constant expansion coefficients, we can define the expectation value of $F$ for a generic measure $\mu$ as 
\begin{equation}
    \ev{F(x)}_\mu = \sum_{\ell = 0}^\infty \sum_{i_1 \cdots i_\ell = 1}^n F_{i_1 \cdots i_\ell} \ev{x_{i_1} \cdots x_{i_\ell}}_\mu;
\end{equation}
for the case of a Gaussian measure we obtain
\begin{equation}
\begin{aligned}
    \ev{F(x)}_0 &= \sum_{\ell = 0}^\infty \sum_{i_1 \cdots i_\ell = 1}^n F_{i_1 \cdots i_\ell} \pdv{b_{i_1}} \cdots \pdv{b_{i_\ell}} \eval{\exp\left(\frac{1}{2}\sum_{i,j=1}^n b_i \Delta_{ij} b_j\right)}_{b=0} \\
    &= F \left(\pdv{b}\right) \eval{\exp\left(\frac{1}{2}\sum_{i,j=1}^n b_i \Delta_{ij} b_j\right)}_{b=0}.
\end{aligned}
\end{equation}
Thus, returning to our potential term,
\begin{equation} \label{eq:z0/zlambda}
\begin{aligned}
    \frac{Z(\lambda)}{Z(0)} &= \ev{e^{-\lambda V(x)}}_0 \\
    &= \exp\left[-\lambda V\left(\pdv{b}\right)\right] \eval{\exp\left(\frac{1}{2}\sum_{i,j=1}^n b_i \Delta_{ij} b_j\right)}_{b=0}.
\end{aligned}
\end{equation}

% TODO: include example for V(x) = 1/4! x^4

\subsection{Perturbed Gaussian Correlators}

The perturbative treatment discussed above can be extended to compute moments of the distribution:
\begin{equation} \label{eq:twopoint_correlator}
    \ev{x_{i_1} \cdots x_{i_l}} = \frac{\int d^nx \, e^{-S(x,\lambda)} x_{i_1} \cdots x_{i_l}}{\int d^nx\, e^{-S(x,\lambda)}} = \frac{1}{Z(\lambda)} \int d^nx\, e^{-S(x,\lambda)} x_{i_1} \cdots x_{i_l}
\end{equation}
which is often referred to as an $\ell$-point correlator/function. Let us start our discussion with a simple example. 
\textbf{Two-point function}: we need to evaluate
\begin{equation}
\begin{aligned} \label{eq:two_point_function}
    \int d^nx \, e^{-S(x, \lambda)} x_{i_1} x_{i_2} &= \int d^nx \, e^{-S_0(x, \lambda)} \left[\sum_{k=0}^n \frac{(-\lambda)^k}{k!} \lambda^k V^k(x)\right] x_{i_1} x_{i_2} \\
    &= Z(0) \sum_{k=0}^n \frac{(-\lambda)^k}{k!} \ev{V^k(x) x_{i_1} x_{i_2}},
\end{aligned}
\end{equation}
where in the second line we have expressed the initial correlator in terms of correlators computed in the Gaussian theory, denoted by $\ev{\cdots}_0$. The Gaussian correlators can be computed using Wick's theorem as before. We shall consider again a quartic potential
\begin{equation}
    V(x) = \frac{1}{4!} \sum_{i=1}^n x_i^4,
\end{equation}
and compute all the terms in Eq. \ref{eq:two_point_function} order by order in $\lambda$ up to order $\lambda^2$.
\begin{itemize}
    \item $\mathcal{O}(\lambda^0)$: For $k=0$ we simply get the two-point Gaussion correlator
    \begin{equation}
        \ev{x_{i_1}x_{i_2}} = \Delta_{i_1 i_2}.
    \end{equation}
    \item $\mathcal{O}(\lambda^1)$: At first order in $\lambda$ we have one insertion of $V$:
    \begin{equation}
        \ev{V(x)x_{i_1} x_{i_2}}_0 = \frac{1}{4!} \sum_{i = 1}^n \ev{x_i^4 x_{i_1} x_{i_2}}_0.
    \end{equation}
    This Gaussian expectation value involving six factors of $x$ can be evaluated using Wick's theorem. There are two types of contractions.
    \begin{enumerate}
        \item $x_1$ is contracted with $x_2$, and the four $x_i$ are contracted amongst themselves:
        \begin{equation}
            \wick{\c x_{i_1} \c x_{i_2}}(\wick{\c1 x_i \c1 x_i \c1 x_i \c1 x_i + \c1 x_i \c2 x_i \c1 x_i \c2 x_i + \c1 x_i \c2 x_i \c2 x_i \c1 x_i}) = \Delta_{i_1 i_2} \ev{x_i^4}_0
        \end{equation}
        \item $x_1$ and $x_2$ are contracted with some of the $x_i$; there are 12 such contractions:
        \begin{equation}
            \wick{\c1 x_{i_1} \c2 x_{i_2} \c1 x_i \c2 x_i x_i x_i} + \cdots = \Delta_{i i_1} \Delta_{i i_2} \Delta_{ii} \times 4 \times 3.
        \end{equation}
        Collecting all the terms yields
        \begin{equation}
            \frac{1}{4!} \sum_{i = 1}^n \ev{x_i^4 x_{i_1} x_{i_2}}_0 = \Delta_{i_1 i_2} \frac{1}{4!} \sum_{i = 1}^n \ev{x_i^4}_0 + \frac{1}{4!} \times 4 \times 3 \sum_{i=1}^n \Delta_{i i_1} \Delta_{i i_2} \Delta_{ii}.
        \end{equation}
    \end{enumerate}
    \item $\mathcal{O}(\lambda^2)$: At this order we need to evaluate
    \begin{equation}
        \frac{1}{2!}\ev{V(x)^2 x_{i_1} x_{i_2}}_0 = \frac{1}{2!} \frac{1}{(4!)^2} \sum_{i,j=1}^n \ev{x_i^4 x_j^4 x_{i_1} x_{i_2}}_0.
    \end{equation}
    There are five different types of contractions, each of them coming with a given multiplicity. We encourage the interested reader to compute those contributions, and check carefullly that the correct multiplicities are recovered. Collecting all contributions yields
    \begin{equation} \label{eq:full_twopoint}
    \begin{aligned}
        \int d^nx e^{-S(x, \lambda)} x_{i_1} x_{i_2} = Z(0) &\Biggl[ \Delta_{i_1 i_2} - \lambda \left(\Delta_{i_1 i_2} \frac{1}{4!} \sum_{i=1}^n \ev{x_i^4}_0 + \frac{1}{2} \sum_{i=1}^n \Delta_{ii_1} \Delta_{ii_2} \Delta_{ii}\right) \\
        &\quad + \lambda^2\Biggl( \frac{1}{2!}\Delta_{i_1 i_2} \frac{1}{(4!)^2} \sum_{i,j=1}^n \ev{x_i^4 x_j^4}_0 + \frac{1}{2!}\sum_{i=1}^n \Delta_{ii_1} \Delta_{ii_2} \Delta_{ii} \frac{1}{4!}\sum_{j=0}^n \ev{x_j^4}_0 \\
        &\quad + \frac{1}{4} \sum_{i,j=1}^n \Delta_{ii_1} \Delta_{ii_2} \Delta_{ij}^2 \Delta_{jj} + \frac{1}{6} \sum_{i,j=1}^n \Delta_{ii_1} \Delta_{ji_2} \Delta_{ij}^3 \\
        &\quad + \frac{1}{4} \sum_{i,j=1}^n \Delta_{ii_1} \Delta_{ji_2} \Delta_{ij} \Delta_{ii } \Delta_{jj} \Biggr)\Biggr].
    \end{aligned}
    \end{equation}
    A term that factorises as the product of a subdiagram with external lines and a subdiagram that is made of loops only is called a \textit{vacuum contribution}. For instance, $\Delta_{i_1 i_2} \frac{1}{4!} \sum_{i=1}^n \ev{x_i^4}_0$ is a vacuum contribution because $\ev{x_i^4}_0$ is one. 

    Finally, we need to divide this expression by $Z(\lambda)$ in order to obtain the two-point correlator as defined in Eq. \ref{eq:twopoint_correlator}. As a result, we obtain a factor $Z(0)/Z(\lambda)$ multiplying the expression inside the square bracket in Eq. \ref{eq:full_twopoint}. The ratio $Z(0)/Z(\lambda)$ may be computed using Eq. \ref{eq:z0/zlambda} and expanding as $1/(1-x) = 1 + x + x^2 + \cdots$ and sorting the terms by powers of $\lambda$ to obtain
    \begin{equation}
        Z(0)/Z(\lambda) = 1 + \frac{1}{4!} \sum_{i=1}^n \ev{x_i^4}_0 - \frac{1}{2!} \frac{1}{(4!)^2} \lambda^2 \sum_{i,j=1}^n \ev{x_i^4 x_j^4}_0 + \frac{1}{(4!)^2} \lambda^2 \left(\sum_{i=1}^n \ev{x_i^4}_0 \right)^2 + \mathcal{0}(\lambda^3)
    \end{equation}
    This cancels all vacuum contributions. % TODO: HOW???
\end{itemize}

\subsection{Generating Functions for the Perturbed Gaussian Measure}

We can now generalise the idea of a generating function to the case of a non-Gaussian measure. Introducing 
\begin{equation}
    Z(b, \lambda) = \int d^nx \exp[-S(x,\lambda) + b_i x_i],
\end{equation}
and remembering that we can also write
\begin{equation}
    \ev{e^{b_i x_i}} = Z(b, \lambda)/Z(\lambda),
\end{equation}
the correlators in the perturbed measure are obtained by differentiation
\begin{equation}
    \ev{x_{i_1} \cdots x_{i_\ell}} = \eval{\frac{1}{Z(\lambda)} \pdv{b_{i_1}} \cdots \pdv{b_{i_\ell}} Z(b, \lambda)}_{b=0}.
\end{equation}

The logarithm of $Z(b, \lambda)$ is usually denoted $W(b, \lambda)$,
\begin{equation}
    Z(b, \lambda) = e^{W(b,\lambda)};
\end{equation}
$W(b, \lambda)$ is the generator of the connected $\ell$-point correlators $W_{i_1 \cdots i_\ell}$, i.e. the correlators that can be represented as a single diagram, with $\ell$ open ends:
\begin{equation}
    W_{i_1 \cdots i_\ell} = \eval{\pdv{b_{i_1}} \cdots \pdv{b_{i_\ell}} W(b, \lambda)}_{b=0}.
\end{equation}
In statistics, the $W_{i_1 \cdots i_\ell}$ are called the \textit{cumulants} of the probability distribution $e^{-S(x, \lambda)}$.

\section{Path Integral Quantum Mechanics}

In this section, we will discuss the essentials of the path integral formulation of quantum mechanics, which will allow us to connect Gaussian integrals and the calculation of correlators to observables in quantum field theory. We consider a point particle in one dimension, with position operator $\hat{Q}$ such that
\begin{equation}
    \hat{Q}\ket{q} = q\ket{q}
\end{equation}
with a completeness condition
\begin{equation}
    \int dq \ket{q} \bra{q} = 1.
\end{equation}
The aim of this section is to find an expression for the quantum amplitude $\braket{q't'}{qt} = \mel{q'}{e^{-i\hat{H}(t'-t)}}{q}$ for a Hamiltonian $\hat{H}$.

\subsection{Setting up the Path Integral}

In order to proceed with the calculation, let us define $T=t'-t$ to be the size of the time interval, and $\epsilon=T/n$, where $n$ is an integer. Then
\begin{equation}
\begin{aligned}
    t_0 &= t \\
    t_k &= t_0 = k\epsilon, k=1, \cdots, n-1 \\
    t_n &= t + n\epsilon = t' \\
\end{aligned}
\end{equation}
and 
\begin{equation}
\begin{aligned}
    \mel{q'}{e^{-i\hat{H}(t'-t)}}{q} &= \mel{q'}{e^{-i\hat{H}T}}{q} \\
    &= \mel{q'}{\left(e^{-i\hat{H}\epsilon}\right) \cdots \left(e^{-i\hat{H}\epsilon}\right)}{q},
\end{aligned}
\end{equation}

where the expression in the second line contains $n$ factors. Inserting the completeness relation $n-1$ times,
\begin{equation}
    \braket{q't'}{qt} \int \prod_{k=1}^{n-1} dq_k \mel{q'}{\left(e^{-i\hat{H}\epsilon}\right)}{q_{n-1}} \mel{q_{n-1}}{\left(e^{-i\hat{H}\epsilon}\right)}{q_{n-2}} \cdots \mel{q_1}{\left(e^{-i\hat{H}\epsilon}\right)}{q}.
\end{equation}

For small $\epsilon$ we can expand the exponential to first order and evaluate the matrix elements:
\begin{equation}
\begin{aligned}
    e^{-i\hat{H}\epsilon} &= 1 - i \hat{H} \epsilon + \mathcal{O}(\epsilon^2) \\
    \hat{H} &= \frac{1}{2} \hat{P} + V(\hat{Q}).
\end{aligned}
\end{equation}

From the potential energy we get
\begin{equation}
\begin{aligned}
    \mel{q_k}{V(\hat{Q})}{q_{k-1}} &= V(q_{k-1})\braket{q_k}{q_{k-1}} \\
    &\approx V\left(\frac{q_k + q_{k-1}}{2}\right) \delta(q_k - q_{k-1}) \\
    &= \int \hat{d}p \, V\left(\frac{q_k + q_{k-1}}{2}\right) e^{ip(q_k - q_{k-1})}.
\end{aligned}
\end{equation}

In order to evaluate the contribution of the kinetic term, we introduce eigenstates of the momentum operator $\ket{p}$
\begin{gather}
    \hat{P} \ket{p} = p \ket{p} \\
    \braket{q}{p} = e^{ipq},
\end{gather}
and use the completeness of the states $\ket{p}$:
\begin{equation}
    \mel{q_k}{\hat{P}^2}{q_{k-1}} = \int \hat{d}p\, p^2 e^{ip(q_k - q_{k-1})}.
\end{equation}
Hence, remembering that the exponential of the Hamiltonian has been expanded to linear order,
\begin{equation}
\begin{aligned}
    \mel{q_k}{e^{-i\hat{H}\epsilon}}{q_{k-1}} &= \mel{q_k}{1-i\epsilon \left(\frac{1}{2}\hat{P}^2 + V(\hat{Q})\right)}{q_{k-1}} \\
    &= \int \hat{d}p \, \left[1 - i\epsilon\left(\frac{1}{2}p^2  + V\left(\frac{q_k + q_{k-1}}{2}\right)\right) e^{ip(q_k - q_{k-1})}\right] \\
    &= \int \hat{d}p \, \exp\left[i\epsilon \left(p \frac{q_k - q_{k-1}}{\epsilon} - H(p, \frac{q_k - q_{k-1}}{2})\right)\right] + \mathcal{O}(\epsilon^2).
\end{aligned}
\end{equation}
Therefore
\begin{equation}
    \braket{q't'}{qt} = \lim_{n\rightarrow \infty} \int \prod_{k=1}^{n-1} dq_k \prod_{j=1}^n \hat{d}p_j \, \exp\left\{i\epsilon \sum_{m=1}^n \left[p_m \frac{q_m - q_{m-1}}{\epsilon} - H\left(p_m, \frac{q_m + q_{m-1}}{2}\right)\right]\right\},
\end{equation}
where $q_0 = q$, and $q_n = q'$. The limit above defines the \textit{path integral} evaluation of the quantum amplitude, which we denote 
\begin{empheq}[box=\widefbox]{align} \label{eq:pathintegral}
    \braket{q't'}{qt} = \int \mathcal{D}q \mathcal{D}p \exp\left\{i\int_t^{t'} d\tau \left[p\dot{q} - H(p, q)\right]\right\}.
\end{empheq}

For Hamiltonians where the momentum dependance is \textbf{only quadratic}, the expression above can be simplified by performing the integral over the momenta $p_j$:
\begin{equation}
    \int \hat{dp} \, \exp\left\{i\epsilon \left[p \frac{q_k - q_{k-1}}{\epsilon} - \frac{1}{2}p^2\right]\right\} = (2\pi i \epsilon)^{-1/2} \exp\left\{i\epsilon \frac{1}{2}\left(\frac{q_k - q_{k-1}}{\epsilon}\right)^2\right\}.
\end{equation}
Using this result, we can rewrite the path integral in Eq. \ref{eq:pathintegral} as 
\begin{equation}
    \braket{q't'}{qt} = \lim_{n\rightarrow \infty} (2\pi i \epsilon)^{-n/2}\int \prod_{k=1}^{n-1} dq_k \exp\left\{i\epsilon \sum_{m=1}^n \left[\frac{1}{2}\left(\frac{q_k - q_{k-1}}{\epsilon}\right)^2 - V\left(\frac{q_m + q_{m-1}}{2}\right)\right]\right\},
\end{equation}
and, assuming that the limit exists, we have obtained the definition of the path integral as an integral over the position of the system only:
\begin{empheq}[box=\widefbox]{align}
    \braket{q't'}{qt} = \int \mathcal{D}q \exp\left\{i\int_t^{t'} d\tau\,  L(q, \dot{q})\right\}.
\end{empheq}
    
\subsection{Correlators}

We are now going to work out expressions for the matrix element of the position operator in between the initial and final state considered above. The first example we are going to consider is the matrix element
\begin{equation}
    \mel{q't'}{\hat{Q}(\bar{t})}{qt} = \mel{q'}{e^{-i\hat{H}(t'-t)}\hat{Q} e^{-i\hat{H}(\bar{t}-t)}}{q},
\end{equation}
where we assume $t < \bar{t} < t'$, and we have used
\begin{equation}
    \hat{Q}(t) = e^{i\hat{H}t} \hat{Q} e^{-i\hat{H}t}.
\end{equation}
Proceeding as we did in the previous section, we can write
\begin{equation}
    \mel{q't'}{\hat{Q}(\bar{t})}{qt} = \mel{q'}{\left(e^{-i\hat{H}\epsilon}\right) \cdots \left(e^{-i\hat{H}\epsilon}\right) \hat{Q} \left(e^{-i\hat{H}\epsilon}\right) \cdots \left(e^{-i\hat{H}\epsilon}\right)}{q}
\end{equation}
where we assumed that $\hat{t} = t_k$, and the first and second ellipses denote respectively $n-k$ and $k$ factors of $\left(e^{-i\hat{H}\epsilon}\right)$. Performing the same manipulations as before we obtain
\begin{equation}
    \mel{q't'}{\hat{Q}(\bar{t})}{qt} = \lim_{n\rightarrow \infty} \int \prod_{k=1}^{n-1} dq_k \prod_{j=1}^n \hat{d}p_j \, q_k \exp\left\{i\epsilon \sum_{m=1}^n \left[p_m \frac{q_m - q_{m-1}}{\epsilon} - H\left(p_m, \frac{q_m + q_{m-1}}{2}\right)\right]\right\}.
\end{equation}
Note the extra factor of $q_k$ in the integrand. We write this limit as 
\begin{equation}
    \mel{q't'}{\hat{Q}(\bar{t})}{qt} = \int_{qq'} \mathcal{D}q\, q(\bar{t}) \exp\left\{i \int_t^{t'} d\tau \mathcal{L}(q, \dot{q})\right\}.    
\end{equation}
The two-point function is 
\begin{equation} \label{eq:twopoint}
    \mel{q't'}{\hat{Q}(\bar{t}_1) \hat{Q}(\bar{t}_2)}{qt},
\end{equation}
where we assume $\bar{t}_1 = t_k$, $\bar{t}_2 = t_\ell$, $t < \bar{t}_2 <  \bar{t}_1 < t'$. Proceeding as above yields
\begin{equation} \label{eq:twopointpath}
    \mel{q't'}{\hat{Q}(\bar{t}_1) \hat{Q}(\bar{t}_2)}{qt} = \int_{qq'}\mathcal{D}q \, q(\bar{t}_1) q(\bar{t}_2) \exp\left\{\int_t^{t'} d\tau \mathcal{L}(q, \dot{q})\right\}.
\end{equation}
There is a subtlety here that is worth noting. The ordering of times in Eq. \ref{eq:twopoint} matters, while it does not in Eq. \ref{eq:twopointpath}. Thus, it is more accurate to say that the path integral we have defined is the result of the \textit{time-ordered product} of the operators
\begin{equation}
\begin{aligned}
    \mel{q't'}{T\left(\hat{Q}(\bar{t}_1) \hat{Q}(\bar{t}_2)\right)}{qt} &= \mel{q't'}{\left(\theta(\bar{t}_1 - \bar{t}_2)\hat{Q}(\bar{t}_1) \hat{Q}(\bar{t}_2)  + \theta(\bar{t}_2 - \bar{t}_1)\hat{Q}(\bar{t}_2) \hat{Q}(\bar{t}_1)\right)}{qt} \\
    &= \int_{qq'}\mathcal{D}q \, q(\bar{t}_1) q(\bar{t}_2) \exp\left\{\int_t^{t'} d\tau \mathcal{L}(q, \dot{q})\right\},
\end{aligned}
\end{equation}
which can be trivially extended to an arbitrary number of insertions of the operator $\hat{Q}$. % TODO: not super happy with how this is presented.

\subsection{Generating functional}

Let us begin with a revision of properties of functional derivatives. A functional $F$ is a mapping from a function $u(x)$ to a number $F[u]$. The functional derivative describes the change of the functional to an infinitesimal variation of the function $u$:
\begin{equation}
    u(x) \mapsto u(x) + \delta u(x).
\end{equation}
We define
\begin{equation}
    \delta F = F[u + \delta u] - F[u] = \int dx \fdv{F}{u(x)} \delta u(x).
\end{equation}
In particular we have the important identity
\begin{equation}
    \fdv{f(x)}f(y) =\delta(x-y).
\end{equation}

Let $f(t)$ and $h(t)$ be two functions. Then we can add so-called source terms to the path integral:
\begin{equation}
    \braket{q't'}{qt}_{f,h} = \int \mathcal{D}q \mathcal{D}p \exp\left\{i\int_t^{t'} d\tau \left[p(\tau)\dot{q}(\tau) - H(p(\tau), q(\tau)) + f(\tau) q(\tau) + h(\tau) p(\tau)\right]\right\}.
\end{equation}
Then we have the useful property that taking functional derivatives with respect to the source fields yields the previously discussed correlators. For example,
\begin{equation}
    \left(\frac{1}{i}\fdv{f(\bar{\tau})}\right) \braket{q't'}{qt}_{f,h} = \int \mathcal{D}q \mathcal{D}p \, q(\bar{\tau})\exp\left\{i\int_t^{t'} d\tau \left[p(\tau)\dot{q}(\tau) - H(p(\tau), q(\tau))\right] + f(\tau) q(\tau) + h(\tau) p(\tau)\right\}.
\end{equation}
The general rule is thus 
\begin{empheq}[box=\widefbox]{align} \label{eq:general_rule}
    \mel{q't'}{T\left(\hat{Q}(t_1) \cdots \hat{Q}(t_n)\right)}{qt} = \eval{\left(\frac{1}{i}\fdv{f(t_1)}\right) \cdots \left(\frac{1}{i}\fdv{f(t_n)}\right) \braket{q't'}{qt}_{f,h}}_{f,h=0}.
\end{empheq}

% TODO: write out derivation of this relation

\begin{empheq}[box=\widefbox]{align}
    \braket{0}{0}_{f,h} = \int \mathcal{D}p \mathcal{D}q \exp\left\{i \int_{-\infty}^{\infty} d\tau \left[p\dot{q} - (1-i\epsilon) H(p, q) + fq + hp \right]\right\}
\end{empheq}

\section{Path Integral for the Scalar Field}

The Lagrangian for a free real scalar field $\phi(x)$ is given by
\begin{equation}
    \mathcal{L}_0(\phi(x)) = \frac{1}{2}\partial_\mu \phi(x)\partial^\mu \phi(x) - \frac{1}{2}m^2 \phi^2(x).
\end{equation}
Note that $\mathcal{L}_0$ is invariant under Lorentz transformations. From the Euler-Lagrange equation, we derive the equation of motion for the field, the Klein-Gordon equation:
\begin{eqnarray}
    (\partial^2+ m^2) \phi(x) = 0.
\end{eqnarray}
Given the conjugate momentum
\begin{equation}
    \Pi(x) = \pdv{\mathcal{L}_0}{(\partial_0 \phi(x))} = \dot{\phi}(x)  
\end{equation}
we obtain the Hamiltonian
\begin{equation}
\begin{aligned}
    \mathcal{H}_0 &= \Pi(x)\dot{\phi(x)} - \mathcal{L}_0(\phi(x)) \\
    &= \frac{1}{2} \Pi^2(x) + \frac{1}{2}\sum_{k=1}^3 (\partial_k \phi(x))^2 + \frac{1}{2}m^2\phi^2(x).
\end{aligned}
\end{equation}
The quadratic Hamiltonian is the generalization of the harmonic oscillator to the case where we have an infinite number of canonical coordinates, indexed by the continuous spatial coordinate $\underline{x}$.


\subsection{Path Integral}

The vacuum-to-vacuum amplitude in the presence of a source field $J(x)$ is the straightforward generalization fo the expression we have derived for the quantum mechanical system:
\begin{equation}
\begin{aligned}
    q(t) &\mapsto \phi(t, \underline{x}) \\
    \hat{Q}(t) &\mapsto \hat{\phi}(t, \underline{x}) \,\text{(operator)} \\
    f(t) &\mapsto J(t, \underline{x})\, \text{(source)}.
\end{aligned}
\end{equation}

By analogy with the QM computation, we can write the expression for the path integral representation of the vacuum amplitude
\begin{equation} \label{eq:vacuum_amplitude}
    Z_0[J] = \braket{0}{0}_J = \int \mathcal{D} \phi \exp\left\{i S_0\right\},
\end{equation}
where
\begin{equation}
    S_0[\phi] = \int d^Dx\, \mathcal{L}_0(\phi(x)) + \int d^Dx\, J(x) \phi(x).
\end{equation}
% For a free theory the integral in Eq. \ref{eq:vacuum_amplitude} is a Gaussian integral; this is why we have made sure to investigate their properties so carefully. In order to make the correspondence more explicit, we can write the action as 
% \begin{equation}
% \begin{aligned}
%     S_0[\phi] &= \int d^Dx \, \frac{1}{2}\partial_\mu \phi(x)\partial^\mu \phi(x) - \frac{1}{2}m^2 \phi^2(x) +  \int d^Dx\, J(x) \phi(x)\\
%     &= \int d^Dx\, d^Dx'\, \phi(x) K(x, x') \phi(x') + \int d^Dx\, J(x) \phi(x).
% \end{aligned}
% \end{equation} 
% % TODO: kernel thing doesn't seem entirely right..?
% Thus the kernel $K(x, x') = - (\partial^2 + m^2) \delta(x - x')$ plays the role of $A_{ij}$ and $J(x)$ the role of $b_i$.

In momentum space, the kernel in the action is diagonal. Thus, introducing the Fourier transform
\begin{equation}
    \phi(x) = \int \hat{d}^Dp\, e^{-ip \cdot x} \tilde{\phi}(p),
\end{equation}
we can rewrite the kinetic term:
\begin{equation}
\begin{aligned}
    \int d^Dx\, \partial_\mu \phi(x) \partial^\mu \phi(x) &= \int d^Dx \int_{p, p'} (-ip_\mu) e^{-ip\cdot x} \tilde{\phi}(p) (-ip'^\mu) e^{-ip'\cdot x} \tilde{\phi}(p') \\
    &= \int_p p^2 \tilde{\phi}(p) \tilde{\phi}(-p) = \int_p p^2 |\tilde{\phi}(p)|^2
\end{aligned}
\end{equation} 
since we have a factor of $\delta(p + p')$ from the exponential and $\tilde{\phi}(-p) = \tilde{\phi}^*(p)$. Hence the action for the field in momentum space can be written as 
\begin{equation}
    S_0[\phi] = \frac{1}{2} \int_p \left\{\tilde{\phi}(-p)\left[p^2-m^2 + i\epsilon\right] \tilde{\phi}(p) + \tilde{J}(p) \tilde{\phi}(-p) + \tilde{J}(-p) \tilde{\phi}(p)\right\}.
\end{equation}

Note that the contribution from the $\epsilon$ term to the exponential is 
\begin{equation}
    \exp{-\epsilon \int_p \left|\tilde{\phi}(p)\right|^2}
\end{equation}
which is clearly convergent for large values of $|\tilde{\phi}(p)|$. The path integral for the free field is a simple extension of the Gaussian integrals that we have discussed previously. % TODO: re-explain how
The Gaussian integral can be computed by performing a shift of the integration variables
\begin{equation}
    \tilde{\chi}(p) = \tilde{\phi}(p) + \frac{\tilde{J}(p)}{p^2-m^2+i\epsilon},
\end{equation}
so that 
\begin{equation}
    S_0[\chi] = \frac{1}{2} \int_p \left\{\tilde{\chi}(-p)[p^2 - m^2 + i\epsilon]\tilde{\chi}(p) - \tilde{J}(-p) \frac{1}{p^2 - m^2 + i\epsilon} \tilde{J}(p) \right\}.
\end{equation}
Then up to a normalization factor (i.e. the kinetic term)
\begin{equation} \label{eq:z0}
\begin{aligned}
    Z_0[J] &\propto \exp \frac{i}{2} \int_p \tilde{J}(-p)\frac{-1}{p^2-m^2+i\epsilon}\tilde{J}(p) \\
    &= \exp -\frac{i}{2} \int d^Dx\, d^Dx' \, J(x) \Delta(x, x') J(x') 
\end{aligned}
\end{equation}
where we have introduced the \textit{Feynman propagator} $\Delta$.
\begin{equation}
    \Delta(x, x') = \Delta(x - x') = \int d^{-ip\cdot(x-x')} \frac{1}{p^2-m^2+i\epsilon}.
\end{equation}
% TODO: add kernel bit.

Recalling Eq. \ref{eq:general_rule} and the fact that $Z_0[J] = \braket{0}{0}_J$, we can write correlators as 
\begin{equation}
\begin{aligned}
    \mel{0}{T\left(\phi(x_1) \phi(x_2)\right)}{0}_0 &= \left(\frac{1}{i}\fdv{J(x_1)}\right)\left(\frac{1}{i}\fdv{J(x_2)}\right) \eval{Z_0[J]}_{J=0} \\
    &= i\Delta(x_1 - x_2).
\end{aligned}
\end{equation}

Further correlators are obtained by taking more derivatives. They can be computed in the free theory using Wick's theorem, again following the arguments we used for Gaussian integrals, e.g.:
\begin{equation}
    \mel{0}{T\left(\phi(x_1)\phi(x_2)\phi(x_3)\phi(x_4)\right)}{0}_0 = i^2[\Delta(x_1-x_2) \Delta(x_3-x_4) + \Delta(x_1-x_3)\Delta(x_2-x_4) + \Delta(x_1-x_4)\Delta(x_2-x_3)].
\end{equation}

\subsection{Interacting Theory}
Let us now add an interaction term in the Lagrangian:
\begin{equation}
    \mathcal{L}(\phi(x)) = \mathcal{L}_0(\phi(x)) + V(\phi(x)).
\end{equation}
We are going to consider several examples, e.g. $\phi^3$ theory:
\begin{equation}
    V(\phi(x)) = \frac{1}{3!}g \phi^3(x).
\end{equation}
% TODO: dimensionality of g
Denoting by $S_0[\phi]$ the action of the free theory, we can write the path integral for the interacting theory
\begin{equation}
    Z[J] = \braket{0}{0}_J = \int \mathcal{D}\phi \exp\left\{i\left(S_0[\phi] + \int d^Dx \, V(\phi(x))\right)\right\}
\end{equation}
By performing the same manipulations as Eq. \ref{eq:z0/zlambda}, we obtain
\begin{equation}
    Z[J] = \exp\left\{i \int d^Dx \, V\left(\frac{1}{i}\fdv{J(x)}\right)\right\} Z_0[J],
\end{equation}
and by expanding both exponentials and substituting in Eq. \ref{eq:z0}, we obtain a perturbative expansion to our generating functional:
\begin{equation}
    Z[J] \propto \sum_{V=0}^\infty \frac{1}{V!} \left[\frac{ig}{3!} \int d^Dx \, \left(\frac{1}{i}\fdv{J(x)}\right)^3\right]^V \times \sum_{P=0}^\infty \frac{1}{P!} \left[-\frac{i}{2} \int d^Dy \, d^Dz \, J(y) \Delta(y-z)J(z)\right]^P
\end{equation}

Since each power of $P$ adds two sources and each power of $V$ removes three sources, we are left with $E=2P-3V$ sources. The functional derivatives turn factors of $J$ in the integrand into Dirac delta functions as following:
\begin{equation}
    \fdv{J(x)}\int \cdots d^dy \cdots J(y)\Delta(y, \cdots) \cdots = \int \cdots \Delta(x, \cdots) \cdots .
\end{equation}
% TODO: Let us look at the details that enter this contribution.

\section{Scalar Field Correlators}

\subsection{The $S$-matrix}

In order to compute the quantum amplitude for a physical process involving arbitrary numbers of particles in the initial and final state, we need to compute the overlap of a state prepared in the distant past (the so-called \textit{in} state), with the resulting final state in the distant future (the so-called \textit{out} state). If we want to describe a $2 \rightarrow n$ process --- like a $pp$ collision at the LHC --- we need to compute 
\begin{equation}
    \braket{p_1, \cdots , p_n; \text{out}}{k_1, k_2; \text{in}}.
\end{equation}

The $S$-matrix allows us to express this scalar product between in- and out-states in terms of the states defined at any common reference time :
\begin{equation}
    \braket{p_1, \cdots , p_n; \text{out}}{k_1, k_2; \text{in}} = \mel{p_1, \cdots , p_n}{S}{k_1, k_2}.
\end{equation}

It is usual to separate the $S$-matrix into the identity operator, corresponding to the particles not interacting, plus a non-trivial \textit{transition matrix} which is usually denoted $T$:
\begin{equation}
    S = 1 + iT.
\end{equation}

\begin{equation}
\begin{aligned}
    \braket{p'_1 \cdots p'_{m'}; \text{out}}{p_1 \cdots p_m; \text{in}} &= \braket{p'_1 \cdots p'_{m'}}{S}{p_1 \cdots p_m} \\
    &= \lim_{p_j^2, \, p_k^{\prime 2} \rightarrow m_{\text{phys}}^2} \prod_{k=1}^{m'} (p_k^{\prime 2} - m_{\text{phys}}^2 + i\epsilon) \prod_{j=1}^{m} (p_j^2 - m_{\text{phys}}^2 + i\epsilon) \\
    & \quad \times \tilde{G}^{(m+m')} (p_1, \cdots, p_m, -p'_1, \cdots, -p'_{m'}),
\end{aligned}
\end{equation}  
where $n=m + m'$, and the fields are normalised so that
\begin{equation}
    \mel{\vb{p}}{\phi(0)}{0} = 1.
\end{equation}


\subsection{Field correlators}
As discussed in the previous lecture, the field correlators are obtained from the partition function by taking functional derivatives:

\begin{equation}
\begin{aligned}
    G^{(n)}(x_1, \cdots , x_n) &= \ev{T\left(\phi(x_1) \cdots \phi(x_n)\right)}{0} \\
    &= \eval{\left(\frac{1}{i}\fdv{J(x_1)}\right) \cdots \left(\frac{1}{i}\fdv{J(x_n)}\right) Z[J]}_{J=0}.
\end{aligned}
\end{equation}

The perturbative definition of the path integral has led to an expansion where we can classify the terms according to the number of currents that appea, which we denoted by $E$ above. Clearly, the only terms that contribute to an $n$-point function are the ones with $E=n$ \footnote{If there are less than $n$ sources, then at least one of the functional derivatives will have nothing to act on, yielding zero. If there are more than $n$ sources, then it will be set to zero when we evaluate the correlator, also yielding zero for the correlator.}. Since we can express $E$ in terms of $P$ and $V$, the calculation of correlators can be expressed as a perturbative expansion in terms of $V$, and therefore in powers of coupling:
\begin{equation}
    G^{(n)}(x_1, \cdots, x_n) = \sum_V g^V G^{(n, V)}(x_1, \cdots , x_n).
\end{equation}

As we will see in future sections, the \textit{LSZ reduction formula} provides a way to connect correlators in momentum space with $S$-matrix elements. This is intimately related to the structure of divergences which we can explore through \textit{polology}. We shall now explore the calculation of two-point position space correlators and the resulting momentum-space expressions.







\end{document}